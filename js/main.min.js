/*! Inventory_Frontend v0.1.0 | (c) 2021 Ali Sajid Imami | GPLv3 License | https://github.com/AliSajid/inventory_frontend */
!function(){"use strict";let e={API_URL:"https://eg558achr2.execute-api.us-east-1.amazonaws.com/api/:action",API_KEY:"GsE5OxhsA5bGhBbWc29X6mRhT6vqgWJ32P96jRK7",showAlertSuccess:function(e,t){const n=document.getElementById("alert");n.className="alert alert-success alert-dismissible fadeIn",n.innerHTML=e,setTimeout((function(){n.className="alert alert-success alert-dismissible fade close",location.reload()}),t)},showAlertFailure:function(e,t){const n=document.getElementById("alert");n.className="alert alert-danger alert-dismissible fadeIn",n.innerHTML=e,setTimeout((function(){n.className="alert alert-success alert-dismissible fade close",location.reload()}),t)},extractName:function(e){return"INPUT"===e.firstChild.nodeName?e.firstChild.value:e.innerHTML},addInventoryRow:function(e){let t=document.getElementById(e).insertRow(-1),n=t.insertCell(0),l=t.insertCell(1),o=document.createElement("input");o.type="text",o.value="",o.className="input-text text-center";let s=document.createElement("input");s.type="number",s.value=0,s.className="input-text text-center",n.appendChild(o),l.appendChild(s)},addInventoryEditor:function(e,t){let n=document.getElementById(t).insertRow(-1),l=n.insertCell(0),o=n.insertCell(1),s=document.createTextNode(e.name),a=document.createElement("input");a.type="number",a.value=e.quantity,l.appendChild(s),o.appendChild(a)},getInventory:function(){let t=new XMLHttpRequest;const n=e.API_URL.replace(":action","inventory");t.open("GET",n),t.setRequestHeader("X-API-KEY",e.API_KEY),t.responseType="json",t.onload=function(){if(200===this.status){let t=this.response;console.log(t);for(let n of t)e.addInventoryEditor(n,"inventory_table_body")}},t.send()},update_item:function(t){let n=new XMLHttpRequest;const l=e.API_URL.replace(":action","item");n.open("POST",l),n.setRequestHeader("X-API-KEY",e.API_KEY),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=function(){200===this.status?(console.log("Successfully uploaded all items."),console.log(this.response),e.showAlertSuccess("Successfully uploaded all items.",3e3)):(console.log("Failed to upload all items"),console.log(this.response),e.showAlertFailure("Failed to upload all items.",3e3))},n.send(JSON.stringify(t))},update_all_items:function(t){let n=document.getElementById(t);for(let t=0;t<n.rows.length;t++){let l={name:e.extractName(n.rows[t].childNodes[0]),quantity:n.rows[t].childNodes[1].firstChild.value};console.log(l),e.update_item(l)}}};document.addEventListener("DOMContentLoaded",(t=>{console.log("DOM fully loaded and parsed"),e.getInventory(),document.getElementById("update_item").onclick=function(t){e.update_all_items("inventory_table_body")},document.getElementById("add_item").onclick=function(t){e.addInventoryRow("inventory_table_body")}}))}();
